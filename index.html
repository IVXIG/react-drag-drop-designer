
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visual Basic 6.0 Clone</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      user-select: none;
    }

    body {
      overflow: hidden;
      background-color: #87CEEB;
    }

    /* General Styles */
    .window {
      position: absolute;
      border: 2px solid #000080;
      border-radius: 3px;
      box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);
      background-color: #F0F0F0;
      z-index: 10;
    }

    .titlebar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2px 4px;
      background-color: #000080;
      color: white;
      cursor: move;
    }

    .title {
      font-weight: bold;
    }

    .window-buttons {
      display: flex;
      gap: 2px;
    }

    .window-button {
      padding: 0px 6px;
      background-color: #D4D0C8;
      color: black;
      border: 1px solid #808080;
      cursor: pointer;
    }

    .window-button:hover {
      background-color: #C0C0C0;
    }

    .window-content {
      overflow: hidden;
    }

    /* Menu and Toolbar */
    .menu-bar {
      width: 100%;
      height: 32px;
      background-color: #D4D0C8;
      border-bottom: 2px solid #000080;
      display: flex;
      align-items: center;
      padding: 0 8px;
    }

    .menu-button {
      background-color: #000080;
      color: white;
      border: 1px solid white;
      border-radius: 3px;
      padding: 4px 12px;
      margin-right: 8px;
      font-weight: bold;
      font-size: 12px;
      cursor: pointer;
      position: relative;
    }

    .menu-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background-color: #D4D0C8;
      border: 1px solid #808080;
      box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      display: none;
    }

    .menu-item {
      padding: 6px 16px;
      cursor: pointer;
      white-space: nowrap;
    }

    .menu-item:hover {
      background-color: #000080;
      color: white;
    }

    .menu-separator {
      height: 1px;
      background-color: #808080;
      margin: 4px 0;
    }

    .toolbar {
      width: 100%;
      height: 40px;
      background-color: #D4D0C8;
      border-bottom: 2px solid #000080;
      display: flex;
      align-items: center;
      padding: 0 8px;
    }

    .toolbar-button {
      display: flex;
      align-items: center;
      padding: 4px 8px;
      background-color: #D4D0C8;
      border: 1px solid #808080;
      border-radius: 3px;
      margin-right: 8px;
      cursor: pointer;
    }

    .toolbar-button:hover {
      background-color: #C0C0C0;
    }

    .toolbar-icon {
      margin-right: 4px;
    }

    .toolbar-separator {
      height: 24px;
      width: 1px;
      background-color: #808080;
      margin: 0 8px;
    }

    /* Toolbox */
    .toolbox {
      position: absolute;
      left: 0;
      top: 72px;
      width: 200px;
      height: calc(100vh - 72px);
      background-color: #F0F0F0;
      border-right: 2px solid #000080;
      box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);
    }

    .toolbox-header {
      padding: 4px 8px;
      background-color: #000080;
      color: white;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
    }

    .toolbox-content {
      display: flex;
      flex-direction: column;
      padding: 8px;
      overflow-y: auto;
      height: calc(100% - 28px);
    }

    .toolbox-category {
      margin-bottom: 8px;
    }

    .toolbox-category-header {
      padding: 4px 8px;
      background-color: #D4D0C8;
      color: #000080;
      font-weight: bold;
      cursor: pointer;
      border: 1px solid #808080;
    }

    .toolbox-category-content {
      padding: 4px;
    }

    .toolbox-item {
      padding: 4px 8px;
      background-color: white;
      border: 1px solid #808080;
      margin-bottom: 4px;
      cursor: move;
      position: relative;
    }

    .toolbox-item:hover {
      background-color: #F0F0F0;
    }

    .delete-control {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 16px;
      height: 16px;
      background-color: #ff5252;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      border-radius: 2px;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .toolbox-item:hover .delete-control {
      opacity: 1;
    }

    /* Designer Canvas */
    .designer-canvas {
      background-color: white;
      width: 100%;
      height: 100%;
      position: relative;
    }

    .canvas-grid {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: repeat(20, 20px);
      grid-template-rows: repeat(20, 20px);
    }

    .grid-cell {
      border: 1px solid #F0F0F0;
    }

    .control {
      position: absolute;
      border: 1px solid transparent;
    }

    .control.selected {
      border: 2px solid #0078D7;
    }

    .control-resize-handle {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 6px;
      height: 6px;
      background-color: #0078D7;
      opacity: 0.7;
      cursor: se-resize;
    }

    /* Property Grid */
    .property-grid {
      height: 100%;
      overflow-y: auto;
    }

    .property-header {
      margin-bottom: 16px;
      padding: 4px 8px;
      background-color: #D4D0C8;
      color: #000080;
      font-weight: bold;
    }

    .property-grid-empty {
      padding: 16px;
      color: #808080;
      font-style: italic;
    }

    .property-grid-table {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1px;
    }

    .property-name {
      padding: 4px 8px;
      background-color: #D4D0C8;
      color: #000080;
      font-weight: bold;
      border: 1px solid #808080;
    }

    .property-value {
      padding: 4px 8px;
      border: 1px solid #808080;
      background-color: white;
    }

    .property-value input {
      width: 100%;
      border: none;
      outline: none;
    }

    /* Project Explorer */
    .project-explorer {
      padding: 8px;
      height: 100%;
      overflow-y: auto;
    }

    .project-header {
      margin-bottom: 8px;
      padding: 4px 8px;
      background-color: #D4D0C8;
      color: #000080;
      font-weight: bold;
    }

    .project-tree {
      list-style: none;
    }

    .project-item {
      margin: 4px 0;
    }

    .folder-item {
      display: flex;
      align-items: center;
      cursor: pointer;
      color: #0000AA;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding-left: 20px;
      color: #006600;
    }

    .folder-icon, .file-icon {
      margin-right: 4px;
    }

    .folder-children {
      padding-left: 16px;
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
    }

    .toast {
      background-color: #333;
      color: white;
      padding: 12px 20px;
      border-radius: 4px;
      margin-top: 8px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s, transform 0.3s;
      max-width: 300px;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .toast.success {
      background-color: #4CAF50;
    }

    .toast.error {
      background-color: #F44336;
    }

    /* Dialog */
    .dialog-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 9000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dialog-container {
      background-color: #D4D0C8;
      border: 2px solid #808080;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 400px;
    }

    .dialog-header {
      padding: 4px 8px;
      background-color: #000080;
      color: white;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
    }

    .dialog-close-btn {
      cursor: pointer;
    }

    .dialog-content {
      padding: 16px;
    }

    .dialog-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 24px;
    }

    .dialog-button {
      padding: 4px 16px;
      background-color: #D4D0C8;
      border: 1px solid #808080;
      cursor: pointer;
    }

    /* Status Bar */
    .status-bar {
      position: fixed;
      bottom: 0;
      width: 100%;
      height: 24px;
      background-color: #D4D0C8;
      border-top: 1px solid #808080;
      display: flex;
      align-items: center;
      padding: 0 8px;
      font-size: 12px;
    }

    .status-item {
      flex: 1;
    }

    .status-separator {
      width: 1px;
      height: 70%;
      background-color: #808080;
      margin: 0 8px;
    }

    /* Code Editor */
    .code-editor {
      position: absolute;
      z-index: 30;
    }

    .code-area {
      width: 100%;
      height: 100%;
      padding: 8px;
      background-color: white;
      overflow: auto;
    }

    .code-textarea {
      width: 100%;
      height: 100%;
      font-family: "Courier New", monospace;
      font-size: 14px;
      outline: none;
      border: 1px solid #808080;
      resize: none;
      padding: 8px;
    }
  </style>
</head>
<body>
  <!-- Top Menu Bar -->
  <div class="menu-bar">
    <div class="menu-button" id="file-menu">File
      <div class="menu-dropdown" id="file-dropdown">
        <div class="menu-item" id="new-project">New Project...</div>
        <div class="menu-item" id="open-project">Open Project...</div>
        <div class="menu-item" id="save-project">Save Project</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="exit">Exit</div>
      </div>
    </div>
    <div class="menu-button" id="edit-menu">Edit
      <div class="menu-dropdown" id="edit-dropdown">
        <div class="menu-item" id="cut">Cut</div>
        <div class="menu-item" id="copy">Copy</div>
        <div class="menu-item" id="paste">Paste</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="delete">Delete</div>
      </div>
    </div>
    <div class="menu-button" id="view-menu">View
      <div class="menu-dropdown" id="view-dropdown">
        <div class="menu-item" id="show-project-explorer">Project Explorer</div>
        <div class="menu-item" id="show-properties-window">Properties Window</div>
        <div class="menu-item" id="show-toolbox">Toolbox</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="show-form-layout">Form Layout</div>
        <div class="menu-item" id="show-code">Code</div>
      </div>
    </div>
    <div class="menu-button" id="project-menu">Project
      <div class="menu-dropdown" id="project-dropdown">
        <div class="menu-item" id="add-form">Add Form</div>
        <div class="menu-item" id="add-module">Add Module</div>
        <div class="menu-item" id="add-class">Add Class</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="project-properties">Project Properties</div>
      </div>
    </div>
    <div class="menu-button" id="format-menu">Format
      <div class="menu-dropdown" id="format-dropdown">
        <div class="menu-item" id="align-left">Align Left</div>
        <div class="menu-item" id="align-center">Align Center</div>
        <div class="menu-item" id="align-right">Align Right</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="make-same-size">Make Same Size</div>
      </div>
    </div>
    <div class="menu-button" id="debug-menu">Debug
      <div class="menu-dropdown" id="debug-dropdown">
        <div class="menu-item" id="start-debug">Start</div>
        <div class="menu-item" id="stop-debug">Stop</div>
        <div class="menu-item" id="break-debug">Break</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="step-into">Step Into</div>
        <div class="menu-item" id="step-over">Step Over</div>
      </div>
    </div>
    <div class="menu-button" id="run-menu">Run
      <div class="menu-dropdown" id="run-dropdown">
        <div class="menu-item" id="start-run">Start</div>
        <div class="menu-item" id="build">Build</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="compile">Compile</div>
      </div>
    </div>
    <div class="menu-button" id="tools-menu">Tools
      <div class="menu-dropdown" id="tools-dropdown">
        <div class="menu-item" id="options">Options...</div>
      </div>
    </div>
    <div class="menu-button" id="addins-menu">Add-Ins
      <div class="menu-dropdown" id="addins-dropdown">
        <div class="menu-item" id="add-in-manager">Add-In Manager...</div>
      </div>
    </div>
    <div class="menu-button" id="window-menu">Window
      <div class="menu-dropdown" id="window-dropdown">
        <div class="menu-item" id="tile-horizontal">Tile Horizontal</div>
        <div class="menu-item" id="tile-vertical">Tile Vertical</div>
        <div class="menu-item" id="cascade">Cascade</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="arrange-icons">Arrange Icons</div>
      </div>
    </div>
    <div class="menu-button" id="help-menu">Help
      <div class="menu-dropdown" id="help-dropdown">
        <div class="menu-item" id="vb-help">Visual Basic Help</div>
        <div class="menu-separator"></div>
        <div class="menu-item" id="about">About...</div>
      </div>
    </div>
  </div>

  <!-- Secondary Toolbar -->
  <div class="toolbar">
    <div class="toolbar-button" id="new-button">
      <span class="toolbar-icon">📄</span> New
    </div>
    <div class="toolbar-button" id="open-button">
      <span class="toolbar-icon">📂</span> Open
    </div>
    <div class="toolbar-button" id="save-button">
      <span class="toolbar-icon">💾</span> Save
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-button" id="run-button">
      <span class="toolbar-icon">▶️</span> Start
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-button" id="view-code-button">
      <span class="toolbar-icon">📝</span> View Code
    </div>
    <div class="toolbar-button" id="view-form-button">
      <span class="toolbar-icon">📄</span> Form
    </div>
  </div>

  <!-- Status Bar -->
  <div class="status-bar">
    <div class="status-item" id="status-mode">Design</div>
    <div class="status-separator"></div>
    <div class="status-item" id="status-project">Project1</div>
    <div class="status-separator"></div>
    <div class="status-item" id="status-modified">Saved</div>
  </div>

  <!-- Toolbox -->
  <div class="toolbox" id="toolbox-window">
    <div class="toolbox-header" id="toolbox-header">Toolbox</div>
    <div class="toolbox-content" id="toolbox-content">
      <div class="toolbox-category">
        <div class="toolbox-category-header" id="common-controls-header">Common Controls</div>
        <div class="toolbox-category-content" id="common-controls-content">
          <div class="toolbox-item" draggable="true" data-control-type="Label">
            Label
            <div class="delete-control" data-control-type="Label">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="TextBox">
            TextBox
            <div class="delete-control" data-control-type="TextBox">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="CommandButton">
            CommandButton
            <div class="delete-control" data-control-type="CommandButton">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="CheckBox">
            CheckBox
            <div class="delete-control" data-control-type="CheckBox">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="OptionButton">
            OptionButton
            <div class="delete-control" data-control-type="OptionButton">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="ComboBox">
            ComboBox
            <div class="delete-control" data-control-type="ComboBox">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="ListBox">
            ListBox
            <div class="delete-control" data-control-type="ListBox">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="Frame">
            Frame
            <div class="delete-control" data-control-type="Frame">✕</div>
          </div>
        </div>
      </div>
      <div class="toolbox-category">
        <div class="toolbox-category-header" id="additional-controls-header">Additional Controls</div>
        <div class="toolbox-category-content" id="additional-controls-content" style="display: none;">
          <div class="toolbox-item" draggable="true" data-control-type="Timer">
            Timer
            <div class="delete-control" data-control-type="Timer">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="PictureBox">
            PictureBox
            <div class="delete-control" data-control-type="PictureBox">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="Image">
            Image
            <div class="delete-control" data-control-type="Image">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="Shape">
            Shape
            <div class="delete-control" data-control-type="Shape">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="Line">
            Line
            <div class="delete-control" data-control-type="Line">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="Data">
            Data
            <div class="delete-control" data-control-type="Data">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="OLE">
            OLE
            <div class="delete-control" data-control-type="OLE">✕</div>
          </div>
          <div class="toolbox-item" draggable="true" data-control-type="ActiveX">
            ActiveX
            <div class="delete-control" data-control-type="ActiveX">✕</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Form Designer Window -->
  <div class="window" id="main-window" style="left: 220px; top: 80px; width: 600px; height: calc(100vh - 140px); z-index: 10;">
    <div class="titlebar" id="main-titlebar">
      <div class="title">Form1.frm [Design]</div>
      <div class="window-buttons">
        <div class="window-button" id="main-minimize">_</div>
        <div class="window-button" id="main-maximize">□</div>
        <div class="window-button" id="main-close">✕</div>
      </div>
    </div>
    <div class="window-content" id="main-content" style="height: calc(100% - 28px);">
      <div class="designer-canvas" id="designer-canvas">
        <div class="canvas-grid" id="canvas-grid"></div>
        <!-- Controls will be dynamically added here -->
      </div>
    </div>
  </div>

  <!-- Project Explorer Window -->
  <div class="window" id="project-window" style="right: 20px; top: 80px; width: 250px; height: calc(50vh - 80px); z-index: 20;">
    <div class="titlebar" id="project-titlebar">
      <div class="title">Project Explorer</div>
      <div class="window-buttons">
        <div class="window-button" id="project-minimize">_</div>
        <div class="window-button" id="project-close">✕</div>
      </div>
    </div>
    <div class="window-content" id="project-content" style="height: calc(100% - 28px);">
      <div class="project-explorer">
        <div class="project-header">Project - Project1</div>
        <ul class="project-tree">
          <li class="project-item">
            <div class="folder-item" data-folder="Project1">
              <span class="folder-icon">📂</span> Project1
            </div>
            <ul class="folder-children" id="project1-children">
              <li class="project-item">
                <div class="file-item" data-file="Form1.frm">
                  <span class="file-icon">📄</span> Form1.frm
                </div>
              </li>
              <li class="project-item">
                <div class="file-item" data-file="Module1.bas">
                  <span class="file-icon">📝</span> Module1.bas
                </div>
              </li>
              <li class="project-item">
                <div class="file-item" data-file="Class1.cls">
                  <span class="file-icon">📋</span> Class1.cls
                </div>
              </li>
              <li class="project-item">
                <div class="folder-item" data-folder="Forms">
                  <span class="folder-icon">📁</span> Forms
                </div>
                <ul class="folder-children" id="forms-children" style="display: none;">
                  <li class="project-item">
                    <div class="file-item" data-file="Form2.frm">
                      <span class="file-icon">📄</span> Form2.frm
                    </div>
                  </li>
                  <li class="project-item">
                    <div class="file-item" data-file="Form3.frm">
                      <span class="file-icon">📄</span> Form3.frm
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Properties Window -->
  <div class="window" id="property-window" style="right: 20px; bottom: 24px; width: 250px; height: calc(50vh - 20px); z-index: 20;">
    <div class="titlebar" id="property-titlebar">
      <div class="title">Properties</div>
      <div class="window-buttons">
        <div class="window-button" id="property-minimize">_</div>
        <div class="window-button" id="property-close">✕</div>
      </div>
    </div>
    <div class="window-content" id="property-content" style="height: calc(100% - 28px);">
      <div class="property-grid" id="property-grid">
        <div class="property-header" id="property-header">Object Properties</div>
        <div class="property-grid-empty" id="property-grid-empty">
          No control selected. Select a control to view its properties.
        </div>
        <div class="property-grid-table" id="property-grid-table" style="display: none;">
          <!-- Properties will be added dynamically here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Code Editor Window (Initially hidden) -->
  <div class="window code-editor" id="code-window" style="left: 250px; top: 100px; width: 500px; height: 400px; display: none; z-index: 30;">
    <div class="titlebar" id="code-titlebar">
      <div class="title">Code Window</div>
      <div class="window-buttons">
        <div class="window-button" id="code-minimize">_</div>
        <div class="window-button" id="code-close">✕</div>
      </div>
    </div>
    <div class="window-content" id="code-content" style="height: calc(100% - 28px);">
      <div class="code-area">
        <textarea class="code-textarea" id="code-textarea" spellcheck="false"></textarea>
      </div>
    </div>
  </div>

  <!-- About Dialog (Initially hidden) -->
  <div class="dialog-backdrop" id="about-dialog" style="display: none;">
    <div class="dialog-container">
      <div class="dialog-header">
        <div>About Visual Basic</div>
        <div class="dialog-close-btn" id="about-close">✕</div>
      </div>
      <div class="dialog-content">
        <div style="text-align: center;">
          <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Microsoft Visual Basic 6.0</h2>
          <p style="margin-bottom: 0.5rem;">This is a web-based recreation of the Visual Basic 6.0 IDE.</p>
          <p style="margin-bottom: 1rem;">Created with HTML, CSS, and JavaScript.</p>
          <div class="dialog-buttons" style="justify-content: center;">
            <button class="dialog-button" id="about-ok-btn">OK</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Script for interactive functionality -->
  <script>
    // Global state
    const state = {
      isDragging: false,
      isResizing: false,
      activeWindow: null,
      dragOffset: { x: 0, y: 0 },
      resizeStart: { x: 0, y: 0, width: 0, height: 0 },
      controlCounter: 0,
      controls: [],
      selectedControl: null,
      windowState: {
        main: { visible: true, minimized: false },
        property: { visible: true, minimized: false },
        project: { visible: true, minimized: false },
        code: { visible: false, minimized: false },
        toolbox: { visible: true, minimized: false }
      },
      isRunning: false,
      isInDesignMode: true,
      projectIsDirty: false,
      openedFile: 'Form1.frm'
    };

    // Initialize the canvas grid
    function initializeGrid() {
      const grid = document.getElementById('canvas-grid');
      grid.innerHTML = '';
      
      for (let row = 0; row < 20; row++) {
        for (let col = 0; col < 20; col++) {
          const cell = document.createElement('div');
          cell.className = 'grid-cell';
          cell.dataset.row = row;
          cell.dataset.col = col;
          grid.appendChild(cell);
        }
      }
    }

    // Show toast notification
    function showToast(message, type = 'default', duration = 3000) {
      const toastContainer = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      
      toastContainer.appendChild(toast);
      
      // Force reflow
      toast.offsetHeight;
      
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          toastContainer.removeChild(toast);
        }, 300);
      }, duration);
    }

    // Make windows draggable
    function makeWindowsDraggable() {
      const windows = ['main', 'property', 'project', 'code'];
      
      windows.forEach(win => {
        const titlebar = document.getElementById(`${win}-titlebar`);
        const window = document.getElementById(`${win}-window`);
        
        titlebar.addEventListener('mousedown', e => {
          if (e.target === titlebar || e.target.classList.contains('title')) {
            state.isDragging = true;
            state.activeWindow = window;
            
            const rect = window.getBoundingClientRect();
            state.dragOffset = {
              x: e.clientX - rect.left,
              y: e.clientY - rect.top
            };
            
            // Bring window to front
            window.style.zIndex = 30;
            
            // Reset other windows z-index
            windows.forEach(otherWin => {
              if (otherWin !== win) {
                const otherWindow = document.getElementById(`${otherWin}-window`);
                if (otherWindow && otherWindow.style.display !== 'none') {
                  otherWindow.style.zIndex = 20;
                }
              }
            });
          }
        });
      });
      
      // Mouse move and mouse up for window dragging
      document.addEventListener('mousemove', e => {
        if (state.isDragging && state.activeWindow) {
          const newLeft = e.clientX - state.dragOffset.x;
          const newTop = e.clientY - state.dragOffset.y;
          
          state.activeWindow.style.left = `${newLeft}px`;
          state.activeWindow.style.top = `${newTop}px`;
        } else if (state.isResizing && state.activeWindow) {
          const newWidth = Math.max(200, state.resizeStart.width + (e.clientX - state.resizeStart.x));
          const newHeight = Math.max(100, state.resizeStart.height + (e.clientY - state.resizeStart.y));
          
          state.activeWindow.style.width = `${newWidth}px`;
          state.activeWindow.style.height = `${newHeight}px`;
        }
      });
      
      document.addEventListener('mouseup', () => {
        state.isDragging = false;
        state.isResizing = false;
        state.activeWindow = null;
      });
    }

    // Window controls (minimize, maximize, close)
    function setupWindowControls() {
      const windows = ['main', 'property', 'project', 'code'];
      
      windows.forEach(win => {
        // Minimize
        const minimizeBtn = document.getElementById(`${win}-minimize`);
        if (minimizeBtn) {
          minimizeBtn.addEventListener('click', () => {
            const window = document.getElementById(`${win}-window`);
            const content = document.getElementById(`${win}-content`);
            
            if (content.style.display === 'none') {
              content.style.display = 'block';
              state.windowState[win].minimized = false;
            } else {
              content.style.display = 'none';
              state.windowState[win].minimized = true;
            }
          });
        }
        
        // Close
        const closeBtn = document.getElementById(`${win}-close`);
        if (closeBtn) {
          closeBtn.addEventListener('click', () => {
            const window = document.getElementById(`${win}-window`);
            window.style.display = 'none';
            state.windowState[win].visible = false;
          });
        }
        
        // Maximize (main window only)
        const maximizeBtn = document.getElementById(`${win}-maximize`);
        if (maximizeBtn) {
          maximizeBtn.addEventListener('click', () => {
            const window = document.getElementById(`${win}-window`);
            
            // Toggle between original size and maximized
            if (window.dataset.isMaximized === 'true') {
              window.style.left = window.dataset.originalLeft;
              window.style.top = window.dataset.originalTop;
              window.style.width = window.dataset.originalWidth;
              window.style.height = window.dataset.originalHeight;
              window.dataset.isMaximized = 'false';
            } else {
              // Save original dimensions
              window.dataset.originalLeft = window.style.left;
              window.dataset.originalTop = window.style.top;
              window.dataset.originalWidth = window.style.width;
              window.dataset.originalHeight = window.style.height;
              
              // Maximize
              window.style.left = '220px';
              window.style.top = '80px';
              window.style.width = 'calc(100vw - 490px)';
              window.style.height = 'calc(100vh - 140px)';
              window.dataset.isMaximized = 'true';
            }
          });
        }
      });
    }

    // Setup Toolbox
    function setupToolbox() {
      // Toggle toolbox categories
      const commonHeader = document.getElementById('common-controls-header');
      const additionalHeader = document.getElementById('additional-controls-header');
      const commonContent = document.getElementById('common-controls-content');
      const additionalContent = document.getElementById('additional-controls-content');
      
      commonHeader.addEventListener('click', () => {
        commonContent.style.display = commonContent.style.display === 'none' ? 'block' : 'none';
      });
      
      additionalHeader.addEventListener('click', () => {
        additionalContent.style.display = additionalContent.style.display === 'none' ? 'block' : 'none';
      });
      
      // Setup drag for toolbox items
      const toolboxItems = document.querySelectorAll('.toolbox-item');
      
      toolboxItems.forEach(item => {
        item.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', item.dataset.controlType);
          showToast(`Dragging ${item.dataset.controlType} control`, 'default');
        });
      });

      // Setup delete buttons for toolbox items
      const deleteButtons = document.querySelectorAll('.delete-control');
      deleteButtons.forEach(button => {
        button.addEventListener('click', (e) => {
          e.stopPropagation();
          const controlType = button.dataset.controlType;
          const parent = button.parentElement;
          
          // Show confirmation before deleting
          if (confirm(`Remove ${controlType} from toolbox?`)) {
            parent.remove();
            showToast(`Removed ${controlType} from toolbox`, 'success');
          }
        });
      });
    }

    // Setup designer canvas for drag and drop
    function setupDesignerCanvas() {
      const canvas = document.getElementById('designer-canvas');
      
      canvas.addEventListener('dragover', e => {
        e.preventDefault();
      });
      
      canvas.addEventListener('drop', e => {
        e.preventDefault();
        const controlType = e.dataTransfer.getData('text/plain');
        
        if (!controlType) return;
        
        const canvasRect = canvas.getBoundingClientRect();
        const x = e.clientX - canvasRect.left;
        const y = e.clientY - canvasRect.top;
        
        addControlToCanvas(controlType, x, y);
      });
      
      // Click on canvas to deselect
      canvas.addEventListener('click', e => {
        if (e.target === canvas || e.target.id === 'canvas-grid') {
          deselectAllControls();
        }
      });
    }

    // Add a control to the canvas
    function addControlToCanvas(controlType, x, y) {
      state.controlCounter++;
      const controlId = `${controlType}_${Date.now()}_${state.controlCounter}`;
      
      // Default properties based on control type
      const defaultWidth = getDefaultWidth(controlType);
      const defaultHeight = getDefaultHeight(controlType);
      
      const controlProperties = {
        name: `${controlType}${state.controlCounter}`,
        left: x,
        top: y,
        width: defaultWidth,
        height: defaultHeight,
        caption: `${controlType}${state.controlCounter}`,
        text: controlType === 'Label' ? 'Label1' : '',
        visible: true,
        enabled: true
      };
      
      // Create the control DOM element
      const control = document.createElement('div');
      control.id = controlId;
      control.className = 'control';
      control.dataset.controlType = controlType;
      control.dataset.controlId = controlId;
      
      control.style.left = `${x}px`;
      control.style.top = `${y}px`;
      control.style.width = `${defaultWidth}px`;
      control.style.height = `${defaultHeight}px`;
      
      // Create content based on control type
      let content = '';
      
      switch (controlType) {
        case 'CommandButton':
          content = `<div class="w-full h-full flex items-center justify-center">${controlProperties.caption}</div>`;
          break;
        case 'TextBox':
          content = `<input type="text" value="${controlProperties.text}" class="w-full h-full border-none outline-none bg-white">`;
          break;
        case 'Label':
          content = `<div class="w-full h-full flex items-center">${controlProperties.text}</div>`;
          break;
        case 'CheckBox':
          content = `
            <div class="flex items-center">
              <input type="checkbox" class="mr-1">
              <span>${controlProperties.caption}</span>
            </div>
          `;
          break;
        case 'OptionButton':
          content = `
            <div class="flex items-center">
              <input type="radio" class="mr-1">
              <span>${controlProperties.caption}</span>
            </div>
          `;
          break;
        case 'ComboBox':
          content = `
            <select class="w-full h-full">
              <option>Item 1</option>
              <option>Item 2</option>
              <option>Item 3</option>
            </select>
          `;
          break;
        case 'ListBox':
          content = `
            <select multiple class="w-full h-full">
              <option>Item 1</option>
              <option>Item 2</option>
              <option>Item 3</option>
            </select>
          `;
          break;
        case 'Frame':
          content = `<div class="w-full h-full p-1 text-center border-t-0">${controlProperties.caption}</div>`;
          control.style.backgroundColor = 'transparent';
          control.style.border = '2px groove #D4D0C8';
          break;
        default:
          content = `<div>${controlType}</div>`;
      }
      
      control.innerHTML = content;
      
      // Add resize handle
      const resizeHandle = document.createElement('div');
      resizeHandle.className = 'control-resize-handle';
      resizeHandle.style.display = 'none';
      control.appendChild(resizeHandle);
      
      // Make control selectable
      control.addEventListener('mousedown', e => {
        e.stopPropagation();
        selectControl(controlId);
        
        if (e.target === resizeHandle) {
          // Start resizing
          state.isResizing = true;
          state.activeWindow = control;
          state.resizeStart = {
            x: e.clientX,
            y: e.clientY,
            width: parseInt(control.style.width),
            height: parseInt(control.style.height)
          };
        } else {
          // Start dragging
          state.isDragging = true;
          state.activeWindow = control;
          
          const rect = control.getBoundingClientRect();
          state.dragOffset = {
            x: e.clientX - rect.left,
            y: e.clientY - rect.top
          };
        }
      });
      
      // Double click to open code window
      control.addEventListener('dblclick', () => {
        openCodeWindow(controlId);
      });
      
      // Add to DOM
      document.getElementById('designer-canvas').appendChild(control);
      
      // Add to state
      state.controls.push({
        id: controlId,
        type: controlType,
        properties: controlProperties
      });
      
      // Select the new control
      selectControl(controlId);
      
      // Mark project as modified
      setProjectModified(true);
      
      showToast(`Added ${controlType} control to form`, 'success');
    }

    // Default dimensions for controls
    function getDefaultWidth(type) {
      switch (type) {
        case 'CommandButton': return 100;
        case 'TextBox': return 150;
        case 'Label': return 80;
        case 'CheckBox': return 120;
        case 'OptionButton': return 120;
        case 'ComboBox': return 150;
        case 'ListBox': return 150;
        case 'Frame': return 200;
        default: return 100;
      }
    }

    function getDefaultHeight(type) {
      switch (type) {
        case 'CommandButton': return 30;
        case 'TextBox': return 24;
        case 'Label': return 24;
        case 'CheckBox': return 24;
        case 'OptionButton': return 24;
        case 'ComboBox': return 24;
        case 'ListBox': return 100;
        case 'Frame': return 150;
        default: return 30;
      }
    }

    // Select a control
    function selectControl(controlId) {
      // Deselect all controls first
      deselectAllControls();
      
      // Find the control
      const control = document.getElementById(controlId);
      if (!control) return;
      
      control.classList.add('selected');
      
      // Show resize handle
      const resizeHandle = control.querySelector('.control-resize-handle');
      if (resizeHandle) {
        resizeHandle.style.display = 'block';
      }
      
      // Find control data
      const controlData = state.controls.find(c => c.id === controlId);
      if (!controlData) return;
      
      state.selectedControl = controlData;
      
      // Update properties grid
      updatePropertiesGrid(controlData);
    }

    // Deselect all controls
    function deselectAllControls() {
      const controls = document.querySelectorAll('.control.selected');
      controls.forEach(control => {
        control.classList.remove('selected');
        
        const resizeHandle = control.querySelector('.control-resize-handle');
        if (resizeHandle) {
          resizeHandle.style.display = 'none';
        }
      });
      
      state.selectedControl = null;
      
      // Clear properties grid
      document.getElementById('property-grid-empty').style.display = 'block';
      document.getElementById('property-grid-table').style.display = 'none';
      document.getElementById('property-header').textContent = 'Object Properties';
    }

    // Update properties grid
    function updatePropertiesGrid(controlData) {
      const emptyMessage = document.getElementById('property-grid-empty');
      const propertiesTable = document.getElementById('property-grid-table');
      const propertiesHeader = document.getElementById('property-header');
      
      if (!controlData) {
        emptyMessage.style.display = 'block';
        propertiesTable.style.display = 'none';
        propertiesHeader.textContent = 'Object Properties';
        return;
      }
      
      // Hide empty message and show properties
      emptyMessage.style.display = 'none';
      propertiesTable.style.display = 'grid';
      propertiesHeader.textContent = `${controlData.type} Properties`;
      
      // Clear existing properties
      propertiesTable.innerHTML = '';
      
      // Add all properties
      for (const [property, value] of Object.entries(controlData.properties)) {
        // Create property name cell
        const propertyNameCell = document.createElement('div');
        propertyNameCell.className = 'property-name';
        propertyNameCell.textContent = property;
        propertiesTable.appendChild(propertyNameCell);
        
        // Create property value cell
        const propertyValueCell = document.createElement('div');
        propertyValueCell.className = 'property-value';
        
        // Create input based on property type
        let input;
        
        if (typeof value === 'boolean') {
          input = document.createElement('input');
          input.type = 'checkbox';
          input.checked = value;
          
          input.addEventListener('change', () => {
            updateControlProperty(controlData.id, property, input.checked);
          });
        } else if (typeof value === 'number') {
          input = document.createElement('input');
          input.type = 'number';
          input.value = value;
          
          input.addEventListener('change', () => {
            updateControlProperty(controlData.id, property, Number(input.value));
          });
        } else {
          input = document.createElement('input');
          input.type = 'text';
          input.value = value;
          
          input.addEventListener('change', () => {
            updateControlProperty(controlData.id, property, input.value);
          });
        }
        
        propertyValueCell.appendChild(input);
        propertiesTable.appendChild(propertyValueCell);
      }
    }

    // Update control property
    function updateControlProperty(controlId, property, value) {
      // Update in state
      const controlData = state.controls.find(c => c.id === controlId);
      if (!controlData) return;
      
      controlData.properties[property] = value;
      
      // Update DOM
      const control = document.getElementById(controlId);
      if (!control) return;
      
      switch (property) {
        case 'left':
          control.style.left = `${value}px`;
          break;
        case 'top':
          control.style.top = `${value}px`;
          break;
        case 'width':
          control.style.width = `${value}px`;
          break;
        case 'height':
          control.style.height = `${value}px`;
          break;
        case 'caption':
          if (controlData.type === 'CommandButton' || 
              controlData.type === 'CheckBox' || 
              controlData.type === 'OptionButton' ||
              controlData.type === 'Frame') {
            const caption = control.querySelector('div, span');
            if (caption) caption.textContent = value;
          }
          break;
        case 'text':
          if (controlData.type === 'Label') {
            const textElement = control.querySelector('div');
            if (textElement) textElement.textContent = value;
          } else if (controlData.type === 'TextBox') {
            const input = control.querySelector('input');
            if (input) input.value = value;
          }
          break;
        case 'visible':
          control.style.display = value ? 'block' : 'none';
          break;
        case 'enabled':
          control.style.opacity = value ? '1' : '0.6';
          const inputs = control.querySelectorAll('input, select');
          inputs.forEach(input => {
            input.disabled = !value;
          });
          break;
      }
      
      // Mark project as modified
      setProjectModified(true);
      
      showToast(`Updated property ${property} to ${value}`, 'success');
    }

    // Set project modified state
    function setProjectModified(isDirty) {
      state.projectIsDirty = isDirty;
      document.getElementById('status-modified').textContent = isDirty ? 'Modified' : 'Saved';
    }

    // Setup Project Explorer
    function setupProjectExplorer() {
      // Toggle folders
      document.querySelectorAll('.folder-item').forEach(folder => {
        folder.addEventListener('click', () => {
          const folderName = folder.dataset.folder;
          const childrenContainer = document.getElementById(`${folderName.toLowerCase()}-children`);
          
          if (childrenContainer) {
            const isVisible = childrenContainer.style.display !== 'none';
            childrenContainer.style.display = isVisible ? 'none' : 'block';
            
            // Update icon
            const folderIcon = folder.querySelector('.folder-icon');
            if (folderIcon) {
              folderIcon.textContent = isVisible ? '📁' : '📂';
            }
          }
        });
      });
      
      // Handle file clicks
      document.querySelectorAll('.file-item').forEach(file => {
        file.addEventListener('click', () => {
          const fileName = file.dataset.file;
          openFile(fileName);
        });
      });
    }

    // Open file
    function openFile(fileName) {
      state.openedFile = fileName;
      document.getElementById('status-project').textContent = fileName;
      
      // Update main window title
      document.querySelector('#main-titlebar .title').textContent = `${fileName} [Design]`;
      
      showToast(`Opened file: ${fileName}`, 'success');
    }

    // Open code window
    function openCodeWindow(controlId) {
      const controlData = state.controls.find(c => c.id === controlId);
      if (!controlData) return;
      
      const codeWindow = document.getElementById('code-window');
      const codeTitle = document.querySelector('#code-titlebar .title');
      const codeTextarea = document.getElementById('code-textarea');
      
      // Update window title
      codeTitle.textContent = `Code Window - ${controlData.properties.name}`;
      
      // Generate placeholder code based on control type
      const controlType = controlData.type;
      const eventType = controlType === 'CommandButton' ? 'Click' : 'Change';
      
      const code = `Private Sub ${controlData.properties.name}_${eventType}()
  ' Add your code here
  MsgBox "Hello from ${controlData.properties.name}!"
End Sub
`;
      
      codeTextarea.value = code;
      
      // Show the window
      codeWindow.style.display = 'block';
      state.windowState.code.visible = true;
      state.windowState.code.minimized = false;
    }

    // Setup Menu Dropdowns
    function setupMenuDropdowns() {
      const menuButtons = document.querySelectorAll('.menu-button');
      
      menuButtons.forEach(button => {
        const dropdownId = button.id;
        const dropdown = document.getElementById(`${dropdownId.split('-')[0]}-dropdown`);
        
        button.addEventListener('click', () => {
          // Close other dropdowns
          document.querySelectorAll('.menu-dropdown').forEach(d => {
            if (d !== dropdown) {
              d.style.display = 'none';
            }
          });
          
          // Toggle this dropdown
          dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        });
      });
      
      // Click outside to close dropdown
      document.addEventListener('click', e => {
        if (!e.target.matches('.menu-button') && !e.target.matches('.menu-item')) {
          document.querySelectorAll('.menu-dropdown').forEach(dropdown => {
            dropdown.style.display = 'none';
          });
        }
      });
      
      // Setup menu item actions
      setupMenuItemActions();
    }

    // Setup Menu Item Actions
    function setupMenuItemActions() {
      // File menu
      document.getElementById('new-project').addEventListener('click', () => {
        showToast('Creating new project...', 'success');
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('open-project').addEventListener('click', () => {
        showToast('Opening project...', 'success');
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('save-project').addEventListener('click', () => {
        showToast('Project saved', 'success');
        setProjectModified(false);
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      // Edit menu
      document.getElementById('cut').addEventListener('click', () => {
        if (state.selectedControl) {
          showToast('Cut ' + state.selectedControl.properties.name, 'success');
        } else {
          showToast('No control selected', 'error');
        }
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('copy').addEventListener('click', () => {
        if (state.selectedControl) {
          showToast('Copied ' + state.selectedControl.properties.name, 'success');
        } else {
          showToast('No control selected', 'error');
        }
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('paste').addEventListener('click', () => {
        showToast('Paste operation', 'success');
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('delete').addEventListener('click', () => {
        if (state.selectedControl) {
          deleteSelectedControl();
        } else {
          showToast('No control selected', 'error');
        }
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      // View menu
      document.getElementById('show-project-explorer').addEventListener('click', () => {
        const window = document.getElementById('project-window');
        window.style.display = 'block';
        state.windowState.project.visible = true;
        state.windowState.project.minimized = false;
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('show-properties-window').addEventListener('click', () => {
        const window = document.getElementById('property-window');
        window.style.display = 'block';
        state.windowState.property.visible = true;
        state.windowState.property.minimized = false;
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      document.getElementById('show-toolbox').addEventListener('click', () => {
        const window = document.getElementById('toolbox-window');
        window.style.display = 'block';
        state.windowState.toolbox.visible = true;
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      // Help menu - About
      document.getElementById('about').addEventListener('click', () => {
        document.getElementById('about-dialog').style.display = 'flex';
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
      
      // Close About dialog
      document.getElementById('about-close').addEventListener('click', () => {
        document.getElementById('about-dialog').style.display = 'none';
      });
      
      document.getElementById('about-ok-btn').addEventListener('click', () => {
        document.getElementById('about-dialog').style.display = 'none';
      });
      
      // Run menu - Start
      document.getElementById('start-run').addEventListener('click', () => {
        toggleRun();
        document.querySelectorAll('.menu-dropdown').forEach(d => {
          d.style.display = 'none';
        });
      });
    }

    // Setup toolbar buttons
    function setupToolbarButtons() {
      document.getElementById('new-button').addEventListener('click', () => {
        showToast('Creating new project...', 'success');
      });
      
      document.getElementById('open-button').addEventListener('click', () => {
        showToast('Opening project...', 'success');
      });
      
      document.getElementById('save-button').addEventListener('click', () => {
        showToast('Project saved', 'success');
        setProjectModified(false);
      });
      
      document.getElementById('run-button').addEventListener('click', toggleRun);
      
      document.getElementById('view-code-button').addEventListener('click', () => {
        if (state.selectedControl) {
          openCodeWindow(state.selectedControl.id);
        } else {
          showToast('No control selected', 'error');
        }
      });
      
      document.getElementById('view-form-button').addEventListener('click', () => {
        const window = document.getElementById('main-window');
        window.style.display = 'block';
        state.windowState.main.visible = true;
        state.windowState.main.minimized = false;
      });
    }

    // Toggle run state
    function toggleRun() {
      if (state.isRunning) {
        state.isRunning = false;
        state.isInDesignMode = true;
        document.getElementById('status-mode').textContent = 'Design';
        document.getElementById('run-button').innerHTML = '<span class="toolbar-icon">▶️</span> Start';
        document.querySelector('#run-dropdown #start-run').textContent = 'Start';
        showToast('Project stopped', 'success');
        
        // Re-enable design functionality
        enableDesignMode();
      } else {
        state.isRunning = true;
        state.isInDesignMode = false;
        document.getElementById('status-mode').textContent = 'Running...';
        document.getElementById('run-button').innerHTML = '<span class="toolbar-icon">⏹️</span> Stop';
        document.querySelector('#run-dropdown #start-run').textContent = 'Stop';
        showToast('Project running', 'success');
        
        // Disable design functionality
        disableDesignMode();
      }
    }

    // Enable design mode
    function enableDesignMode() {
      // Re-enable dragging and selection
      state.controls.forEach(controlData => {
        const control = document.getElementById(controlData.id);
        if (control) {
          control.style.pointerEvents = 'auto';
        }
      });
    }

    // Disable design mode
    function disableDesignMode() {
      // Deselect controls
      deselectAllControls();
      
      // Disable dragging and selection
      state.controls.forEach(controlData => {
        const control = document.getElementById(controlData.id);
        if (control) {
          control.style.pointerEvents = 'none';
        }
      });
    }

    // Delete selected control
    function deleteSelectedControl() {
      if (!state.selectedControl) return;
      
      const controlId = state.selectedControl.id;
      const controlName = state.selectedControl.properties.name;
      
      // Remove from DOM
      const control = document.getElementById(controlId);
      if (control) {
        control.remove();
      }
      
      // Remove from state
      state.controls = state.controls.filter(c => c.id !== controlId);
      
      // Clear selection
      state.selectedControl = null;
      
      // Update properties grid
      document.getElementById('property-grid-empty').style.display = 'block';
      document.getElementById('property-grid-table').style.display = 'none';
      document.getElementById('property-header').textContent = 'Object Properties';
      
      // Mark project as modified
      setProjectModified(true);
      
      showToast(`Deleted control: ${controlName}`, 'success');
    }

    // Enable text input in TextBox controls
    function enableTextInputs() {
      // Listen for input events on TextBox controls
      document.addEventListener('input', e => {
        if (e.target.tagName === 'INPUT' && e.target.type === 'text') {
          // Find the parent control
          let control = e.target.closest('.control');
          if (control) {
            const controlId = control.dataset.controlId;
            const controlData = state.controls.find(c => c.id === controlId);
            
            if (controlData && controlData.type === 'TextBox') {
              // Update the text property
              controlData.properties.text = e.target.value;
              
              // If this control is selected, update properties grid
              if (state.selectedControl && state.selectedControl.id === controlId) {
                updatePropertiesGrid(controlData);
              }
              
              // Mark project as modified
              setProjectModified(true);
            }
          }
        }
      });
    }

    // Initialize the app
    function initializeApp() {
      initializeGrid();
      makeWindowsDraggable();
      setupWindowControls();
      setupToolbox();
      setupDesignerCanvas();
      setupProjectExplorer();
      setupMenuDropdowns();
      setupToolbarButtons();
      enableTextInputs();
      
      // Show initial toast
      showToast('Welcome to Visual Basic 6.0 Web Edition', 'success');
    }

    // Start the app when the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>
</body>
</html>
